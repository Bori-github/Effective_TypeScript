# `number` 인덱스 시그니처보다는 `Array`, 튜플, `ArrayLick`를 사용하기 | Effective TypeScript

## 자바스크립트의 암묵적 타입 변환
자바스크립트는 암묵적 타입 변환으로 인해 개발자가 의도한대로 동작하지 않는 경우가 있습니다.
이번 아이템에서는 암묵적 타입 변환으로 인한 자바스크립트 객체 모델의 이상한 점에 대해 다룹니다.

자바스크립트에서 배열은 숫자 인덱스를 통해 배열의 요소에 접근할 수 있습니다. 또한, 문자열 키를 사용해 배열의 요소에 접근할 수 있습니다.

![](https://github.com/Bori-github/Effective_TypeScript/assets/85009583/a4e18b6f-cb7e-4e66-bc59-0f27da9ef3d5)

**문자열 키를 사용해 배열의 요소에 접근할 수 있는 이유는 무엇일까요?**
자바스크립트의 배열은 객체 타입이기 때문입니다.

자바스크립트에서 객체란 키/값 쌍의 모음입니다. 이 때 키는 문자열이나 심벌 타입만 가능하고, 숫자는 키로 사용할 수 없습니다. 만약 숫자로 된 키를 사용하려고 하면, 자바스크립트 런타임은 문자열로 변환합니다.

따라서, 숫자 인덱스를 통해 배열의 요소에 접근하면 자바스크립트 엔진이 암묵적 타입 변환을 통해 숫자 인덱스를 문자열로 변환하고, 이를 통해 배열의 요소에 접근하게 됩니다.

`Object.keys`를 이용해 배열의 키를 나열해보면, 키가 문자열로 출력됩니다.

![](https://github.com/Bori-github/Effective_TypeScript/assets/85009583/c00aff2e-34bc-4e89-9723-261b1335d1b5)

## 인덱스 시그니처에 `number` 타입 사용하기
타입스크립트는 이러한 문제점을 해결하기 위해 숫자 키를 허용합니다.
`lib.es5.d.ts` 에 선언된 `Array`의 타입 정의를 보면 숫자 타입의 키를 허용하고 있습니다.

![](https://github.com/Bori-github/Effective_TypeScript/assets/85009583/a34a1377-75c9-46f3-844f-976267d7122d)

실제로 타입스크립트의 타입은 런타임에 제거되고 객체의 키는 문자열로 타입 변환이 되지만, **타입 체크 시점에 오류를 잡을 수 있습니다.**

따라서, 인덱스 시그니처가 숫자 타입으로 되어있더라도 실제 런타임에 사용되는 키는 문자열입니다.
만약 숫자를 인덱스 타입으로 사용해야하는 경우 새로운 타입을 정의하여 사용하는 것보다 이미 정의되어 있는 `Array`, 튜플, `ArrayLike` 타입을 사용하는 것이 좋습니다.

> `Array` 타입을 사용하는 경우 배열 메서드를 사용할 수 있으나, `ArrayLike` 는 배열 메서드를 사용할 수 없습니다. 배열 메서드가 필요하지 않은 경우 `ArrayLike` 타입을 사용하는 것이 좋습니다.
> `lib.es5.d.ts` 에 선언된 `ArrayLike`의 타입에는 `Array`의 타입 정의에는 포함되어있던 메서드 타입에 대한 정의가 포함되어 있지 않습니다.
> ![](https://github.com/Bori-github/Effective_TypeScript/assets/85009583/287c1cfe-49db-41dc-831b-fe7ac5a071e6)

## 마무리
자바스크립트의 배열은 객체이므로 키는 숫자가 아닌 문자열입니다.

인덱스 시그니처로 사용된 숫자 타입은 타입 체크 시점에 버그를 잡기 위한 순수 타입스크립트 코드입니다. 그러므로 실제로 런타임에는 키가 문자열로 변환된다는 것을 이해하고 사용해야 합니다.

숫자를 인덱스 타입으로 사용한다면 숫자 속성이 특별한 의미를 가진다는 오해가 발생할 수 있으므로 인덱스 시그니처에 숫자 타입을 사용하는 것보다 `Array`, 튜플, `ArrayLike` 타입을 사용하는 것이 좋습니다.

> #### 참고
> - [[이펙티브 타입스크립트+16] number 인덱스 시그니처보다는 Array, 튜플, ArrayLike를 사용하기](https://junghyunkim.tistory.com/entry/%EC%9D%B4%ED%8E%99%ED%8B%B0%EB%B8%8C-%ED%83%80%EC%9E%85%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B816-number-%EC%9D%B8%EB%8D%B1%EC%8A%A4-%EC%8B%9C%EA%B7%B8%EB%8B%88%EC%B2%98%EB%B3%B4%EB%8B%A4%EB%8A%94-Array-%ED%8A%9C%ED%94%8C-ArrayLike%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0)