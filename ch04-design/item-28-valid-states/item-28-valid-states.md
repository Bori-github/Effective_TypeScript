# 유효한 상태만 표현하는 타입을 지향하기 | Effective TypeScript

타입을 잘 설계하면 코드는 직관적으로 작성할 수 있습니다.
효과적으로 타입을 설계하려면, 유효한 상태만 표현할 수 있는 타입을 만들어 내는 것이 중요합니다.

## 유효한 상태와 무효한 상태
### 유효한 상태

- 해당 타입이 가질 수 있는 유효한 값의 범위나 제약 조건
- 해당 타입의 규칙과 제약 조건에 부합하는 상태

⇒ 올바르고 예상된 형태의 데이터를 나타내며, 코드의 실행과 로직에 문제가 없는 상태를 의미합니다.

### 무효한 상태

- 해당 타입이 가질 수 없는 유효하지 않은 값이나 상태
- 타입의 규칙과 제약 조건에 어긋나 프로그램의 예상 동작과는 일치하지 않는 상태

⇒ 올바르지 않거나 예상치 못한 형태의 데이터를 나타내며, 코드의 실행과 로직에 문제가 있는 상태를 의미합니다.

## 무효한 상태가 나타나는 예시 코드

웹 애플리케이션 페이지를 나타낸다고 가정해 보겠습니다.
페이지에 접근하면 상태에 따라 내용을 나타냅니다. 따라서, 상태 객체의 필드를 전부 고려해야합니다.

![img_1](https://github.com/Bori-github/Effective_TypeScript/assets/85009583/c30db8d2-2732-4c21-82f8-05828ef81fe9)

상태를 나타내는 타입은 위와 같이 정의되어 있고, `error`는 선택적 프로퍼티 입니다.
페이지를 나타내는 함수에 `state.error`값이 존재할 경우, 에러가 발생했다는 메시지를 보여줍니다.
그리고 `state.isLoading`이 `ture`일 경우, 로딩 중임을 알리는 메시지는 보여줍니다.

만약 `state.isLoading`이 `ture`이고, `error` 값이 존재한다면 어떻게 될까요?
분기 조건이 명확하게 분리되어 있지 않아 어떠한 결과가 나타날 지 예상할 수 없습니다.
이러한 경우 무효한 상태를 나타내게 됩니다.

## 유효한 상태만 표현하기

유효한 상태만 나타내기 위해 상태에 대한 타입을 더 자세히 표현해야 합니다.

![img_2](https://github.com/Bori-github/Effective_TypeScript/assets/85009583/cb55f3d6-7160-4bfb-928a-2b7431f6c2f3)

요청 과정 각각의 상태를 명시적으로 정의하고, 요청 상태를 나타내는 `RequestState`는 유니온 타입을 사용하여 정의하였습니다.
그리고 페이지를 나타내는 함수에 적용해보겠습니다.

![img_3](https://github.com/Bori-github/Effective_TypeScript/assets/85009583/fa279ac3-6393-4aeb-953c-a08ef8342fa7)

매개변수인 상태 객체를 비구조화 문법을 사용하여 `requests`의 속성값을 가져옵니다. 그리고 `requests` 상태에 따라 분기처리를 하여 데이터를 나타냅니다.

타입 설계에서 발생하는 모든 요청의 상태를 고려하여 모델링 했기 때문에, 페이지를 나타낼 때 명확한 분기처리가 가능하고, 모든 요청이 정확히 하나의 상태로 맞아 떨어져 예상된 형태의 데이터를 나타냅니다.

타입 코드의 길이가 길어졌지만, 모든 요청 상태를 타입으로 정의하면서 코드 작성이 쉬워지고 타입 체크가 용이해졌습니다.

## 마무리
- 무효한 상태라는 것은 예상치 못한 동작을 하거나 데이터를 나타내는 상태를 말합니다. 무효한 상태를 나타내지 않기 위해서는 유효한 상태만 표현하는 타입을 지향해야 합니다.
- 효과적인 타입을 설계하기 위해 타입 코드가 길어지거나 표현하기 어려울 수 있습니다.
- 하지만 유효한 상태만 나타내는 타입을 설계한다면 코드 작성이 쉬워지고 타입 체크가 용이해집니다.
